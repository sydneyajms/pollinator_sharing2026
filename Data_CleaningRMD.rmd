---
title: "Data_Cleaning"
output: html_document
date: "2026-01-20"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyr)
library(dplyr)
```

Cleaning seed data to remove incomplete data points 
```{r}
bigseeds <- read.csv("RFseed_data - Sydney RF seeds.csv")

# convert empty or 0 blooms to NAs
bigseeds$Cblooms <- as.integer(bigseeds$Cblooms)
bigseeds["Oblooms" == ""| "Oblooms" == 0] <- NA
bigseeds["Cblooms" == ""| "Cblooms" == 0] <- NA

# remove NAs  
completeseeds <- bigseeds %>%
  drop_na(Cblooms, Oblooms) %>%
  mutate(OsPerb = total.open/Oblooms, 
         CsPerb = total.closed/Cblooms)

# select only needed columns 
neededData <- subset(completeseeds, 
                     select = c(Block, Plot, genSpec, sp, fc, OsPerb, CsPerb))
neededData$sp <- recode(neededData$sp, 
                        "CA" = "CLAAMO",
                        "ME" = "MADELE",
                        "CP" = "CLAPUR",
                        "MG" = "MICGRA")

# save as cleaned csv file 
write.csv(neededData, "Cleaned_seeds.csv", row.names = FALSE) 
```
 
 Read in Bee data and prepare to be joined to seed data 
```{r}
BeeNos <- read.csv("BEE IDs - RF 24 - Sheet1.csv") 

BeePlants <- read.csv("Specimens_Riverfront_JA - Sheet1.csv")

# remove uneeded columns
BeePlantsOnly <- subset(BeePlants, select = -c (FreezerBoxNum, Collector, SampleRound, Date, Year, Notes))

# rename to match ID data 
BeePlantsOnly <- BeePlantsOnly %>%
  rename("sp.no" = Unique.ID, 
          "sp" = FieldPlantID)  

# join Bee plants to genus (Run this to reset all pollinators)
Pollinators <- BeePlantsOnly %>%
  inner_join(BeeNos)

# remove all non-pollinators (keep syrphid genera only) and rename plants to codes
EffPollinators <- Pollinators %>%
  filter(!Genus %in% c("unidentifiable ", "beetle larve", "gymnosoma", "rhamphomyia ", "cylindromyia"))

EffPollinators$sp <- recode(EffPollinators$sp, 
         "PC" = "PLECON",
         "PF" = "PLAFIG",
         "CP" = "CLAPUR",
         "GD" = "GERDIS",
         "GC" = "GILCAP",
         "ME" = "MADELE",
         "CA" = "CLAAMO",
         "MG" = "MICGRA",
         "CG" = "COLLOGRA",
         "NS" = "NAVSQUA")
 
# save as cleaned csv file 
write.csv(EffPollinators, "Pollinator_data_cleaned.csv", row.names = FALSE) 

```
